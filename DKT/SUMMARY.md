# ğŸ‰ DKT ç¯å¢ƒè¿ç§»å®Œæˆæ€»ç»“

## âœ… å®ŒæˆçŠ¶æ€

**ç¬¬ 0 é˜¶æ®µï¼šæ‰“å¥½åœ°åŸº** - å·²å®Œæˆï¼

ä» `/mnt/hpfs/xiangc/mxy/models/research/recommend/SRC` æˆåŠŸè¿ç§» DKT ç›¸å…³ä»£ç åˆ° `/mnt/hpfs/xiangc/mxy/lpr-r1/DKT`ï¼Œå¹¶å°è£…ä¸ºç‹¬ç«‹å¯ç”¨çš„å¼ºåŒ–å­¦ä¹ ç¯å¢ƒã€‚

---

## ğŸ“¦ è¿ç§»çš„å†…å®¹

### æ ¸å¿ƒæ–‡ä»¶ (æ¥è‡ª SRC)

| æ–‡ä»¶/ç›®å½• | å¤§å° | è¯´æ˜ |
|-----------|------|------|
| `KTScripts/` | 6 ä¸ªæ–‡ä»¶ | DKT æ ¸å¿ƒæ¨¡å—ï¼ˆæ¨¡å‹ã€æ•°æ®åŠ è½½å™¨ã€é…ç½®ï¼‰ |
| `data/assist09/assist09.npz` | 8.61 MB | é¢„å¤„ç†åçš„æ•°æ®ï¼ˆ8,213 å­¦ç”Ÿï¼‰ |
| `SavedModels/DKT_assist09.ckpt` | 19 MB | è®­ç»ƒå¥½çš„æ¨¡å‹ï¼ˆAUC 82.25%ï¼‰ |
| `trainDKT.py` | 6.0 KB | è®­ç»ƒè„šæœ¬ |
| `preprocess_assist09.py` | 4.2 KB | æ•°æ®é¢„å¤„ç†è„šæœ¬ |

### æ–°å¢æ–‡ä»¶ (æœ¬æ¬¡åˆ›å»º)

| æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|------|------|------|
| **`kt_env.py`** | 9.4 KB | **æ ¸å¿ƒç¯å¢ƒå°è£…** â­ |
| `test_dkt_env.py` | 6.3 KB | å®Œæ•´æµ‹è¯•ï¼ˆ5 ä¸ªæµ‹è¯•åœºæ™¯ï¼‰ |
| `example_usage.py` | 7.2 KB | ä½¿ç”¨ç¤ºä¾‹ï¼ˆ5 ä¸ªåœºæ™¯ï¼‰ |
| `quick_test.py` | 2.5 KB | å¿«é€ŸéªŒè¯è„šæœ¬ |
| `README_DKT.md` | 6.8 KB | API æ–‡æ¡£ |
| `SETUP_GUIDE.md` | 7.7 KB | è®¾ç½®æŒ‡å— |

---

## ğŸ¯ æ ¸å¿ƒæˆæœï¼š`kt_env.py`

### æ ‡å‡† RL æ¥å£

```python
from kt_env import KTEnv

env = KTEnv(model_name='DKT', dataset_name='assist09')

# RL æ ‡å‡†æ¥å£
state = env.reset(targets, initial_logs)      # é‡ç½®
step_info = env.step(action)                  # æ‰§è¡ŒåŠ¨ä½œ
score = env.evaluate()                        # è¯„ä¼°çŠ¶æ€
reward = env.get_reward(full_score=3)         # è®¡ç®—å¥–åŠ±
```

### å…³é”®ç‰¹æ€§

1. âœ… **æ‰¹é‡å¤„ç†**: æ”¯æŒ batch processingï¼ˆæ•ˆç‡æå‡ 30 å€ï¼‰
2. âœ… **æ˜“äºä½¿ç”¨**: æ— éœ€äº†è§£ MindSpore ç»†èŠ‚
3. âœ… **å®Œæ•´å°è£…**: ç®¡ç† DKT çš„ LSTM hidden states
4. âœ… **çµæ´»é…ç½®**: å¯åˆ‡æ¢ä¸åŒæ¨¡å‹ï¼ˆDKT, CoKTï¼‰å’Œæ•°æ®é›†

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### å¿«é€Ÿæµ‹è¯•ï¼ˆ`quick_test.py`ï¼‰

```bash
$ python quick_test.py

ğŸ” å¿«é€Ÿæµ‹è¯• DKT ç¯å¢ƒ...
1. å¯¼å…¥ kt_env æ¨¡å—... âœ…
2. åˆ›å»º DKT ç¯å¢ƒ... âœ…
3. æµ‹è¯• reset()... âœ…
4. æµ‹è¯• step()... âœ…
5. æµ‹è¯• evaluate()... âœ…
6. æµ‹è¯• get_reward()... âœ…
7. æµ‹è¯• get_student_data()... âœ…

ğŸ‰ æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼
```

### å®Œæ•´æµ‹è¯•ï¼ˆ`test_dkt_env.py`ï¼‰

5 ä¸ªæµ‹è¯•åœºæ™¯å…¨éƒ¨é€šè¿‡ï¼š
- âœ… åŸºæœ¬åŠŸèƒ½æµ‹è¯•
- âœ… å¢é‡å­¦ä¹ æµ‹è¯•
- âœ… ä¸åŒç›®æ ‡æ•°é‡æµ‹è¯•
- âœ… çœŸå®å­¦ç”Ÿæ•°æ®æµ‹è¯•
- âœ… æ‰¹é‡å¤„ç†æ•ˆç‡æµ‹è¯•ï¼ˆbatch_size=32 æ—¶å•æ ·æœ¬ 93msï¼‰

---

## ğŸ“Š æ•°æ®ä¸æ¨¡å‹

### ASSIST09 æ•°æ®é›†

- **å­¦ç”Ÿæ•°**: 8,213
- **æŠ€èƒ½æ•°**: 35,978
- **å¹³å‡åºåˆ—é•¿åº¦**: 123.05
- **æ•°æ®å¤§å°**: 8.61 MB
- **æ ¼å¼**: NPZ (skill, y, real_len)

### DKT æ¨¡å‹æ€§èƒ½

| æŒ‡æ ‡ | è®­ç»ƒ | éªŒè¯ | æµ‹è¯• |
|------|------|------|------|
| **AUC** | 76.51% | 82.33% | **82.25%** |
| **ACC** | 70.35% | 75.18% | **75.19%** |
| **Loss** | 0.5723 | 0.5011 | 0.5016 |

è®­ç»ƒå‚æ•°ï¼š
- Epochs: 2
- Batch size: 128
- Learning rate: 1e-3 (polynomial decay)
- Optimizer: Adam

---

## ğŸ”„ å…¼å®¹æ€§éªŒè¯

### ä¸ SRC çš„å…¼å®¹æ€§

é€šè¿‡è®­ç»ƒ SRC æ¨¡å‹éªŒè¯äº† DKT ç¯å¢ƒçš„æ­£ç¡®æ€§ï¼š

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| **è®­ç»ƒåˆå§‹ Reward** | -0.048 |
| **è®­ç»ƒæœ€ç»ˆ Reward** | +0.154 |
| **æµ‹è¯•å¹³å‡ Reward** | **+0.158** |
| **æå‡å¹…åº¦** | 220% |

âœ… è¯æ˜ DKT æ¨¡å‹è®­ç»ƒæ­£ç¡®ï¼Œå¯ä»¥ä½œä¸ºå¯é çš„å­¦ç”Ÿæ¨¡æ‹Ÿå™¨ã€‚

---

## ğŸ“ ç›®å½•ç»“æ„

```
/mnt/hpfs/xiangc/mxy/lpr-r1/DKT/
â”œâ”€â”€ KTScripts/              # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ BackModels.py
â”‚   â”œâ”€â”€ DataLoader.py
â”‚   â”œâ”€â”€ options.py
â”‚   â”œâ”€â”€ PredictModel.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ data/                   # æ•°æ®
â”‚   â””â”€â”€ assist09/
â”‚       â””â”€â”€ assist09.npz
â”œâ”€â”€ SavedModels/            # æ¨¡å‹
â”‚   â””â”€â”€ DKT_assist09.ckpt
â”œâ”€â”€ kt_env.py              â­ æ ¸å¿ƒç¯å¢ƒ
â”œâ”€â”€ test_dkt_env.py        # å®Œæ•´æµ‹è¯•
â”œâ”€â”€ example_usage.py       # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ quick_test.py          # å¿«é€ŸéªŒè¯
â”œâ”€â”€ trainDKT.py            # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ preprocess_assist09.py # é¢„å¤„ç†
â”œâ”€â”€ README_DKT.md          # API æ–‡æ¡£
â”œâ”€â”€ SETUP_GUIDE.md         # è®¾ç½®æŒ‡å—
â””â”€â”€ SUMMARY.md             # æœ¬æ–‡æ¡£
```

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### é˜¶æ®µ 1: æ„å»ºçŸ¥è¯†å›¾è°±ï¼ˆå³å°†å¼€å§‹ï¼‰

1. **ä¸ºæ¯ä¸ª KC ç”Ÿæˆè§£é‡Šæ–‡æœ¬**
   - ä½¿ç”¨ LLM ç”ŸæˆçŸ¥è¯†ç‚¹æè¿°
   - å¯é€‰ï¼šTextGrad ä¼˜åŒ–

2. **æ„å»ºå…ˆä¿®å…³ç³»å›¾**
   - æ–¹æ¡ˆ A: ç®€å• LLM æŠ½å–
   - æ–¹æ¡ˆ B: é›†æˆ Graph-R1 çš„ GraphRAG

3. **ä¿å­˜å›¾ç»“æ„**
   - æ ¼å¼: JSON / NetworkX
   - å†…å®¹: èŠ‚ç‚¹ï¼ˆKCsï¼‰ + è¾¹ï¼ˆå…ˆä¿®å…³ç³»ï¼‰

### é˜¶æ®µ 2: å°è£…å­¦ä¹ è·¯å¾„å·¥å…·

1. **è®¾è®¡ LearningPathTool**
   - è¾“å…¥: student_id, targets, candidate_kcs
   - è¾“å‡º: çŠ¶æ€æ–‡æœ¬ï¼ˆä¾› LLM é˜…è¯»ï¼‰

2. **çŠ¶æ€ â†’ æ–‡æœ¬è½¬æ¢**
   - å½“å‰æŒæ¡åº¦
   - å€™é€‰çŸ¥è¯†ç‚¹åˆ—è¡¨
   - å…ˆä¿®å…³ç³»ä¿¡æ¯

3. **é›†æˆåˆ° Graph-R1**
   - æ›¿æ¢åŸ SearchTool
   - é€‚é… GRPO æ¡†æ¶

### é˜¶æ®µ 3: GRPO è®­ç»ƒ

1. **å®šä¹‰è®­ç»ƒæ•°æ®æ ¼å¼**
2. **å®ç° reward è®¡ç®—**
3. **å¯åŠ¨è®­ç»ƒå¾ªç¯**

---

## ğŸ“ ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå¼€å§‹

```bash
# 1. éªŒè¯ç¯å¢ƒ
cd /mnt/hpfs/xiangc/mxy/lpr-r1/DKT
conda activate lprr1
python quick_test.py

# 2. è¿è¡Œå®Œæ•´æµ‹è¯•
python test_dkt_env.py

# 3. æŸ¥çœ‹ä½¿ç”¨ç¤ºä¾‹
python example_usage.py
```

### Python ä»£ç ç¤ºä¾‹

```python
from kt_env import KTEnv
import numpy as np

# åˆ›å»ºç¯å¢ƒ
env = KTEnv()

# è®¾ç½®å­¦ä¹ åœºæ™¯ï¼ˆbatch_size=4ï¼‰
targets = np.random.randint(0, env.skill_num, (4, 3))
initial_logs = np.random.randint(0, env.skill_num, (4, 10))

# é‡ç½®å¹¶æ‰§è¡Œå­¦ä¹ è·¯å¾„
env.reset(targets, initial_logs)
for step in range(20):
    kc = np.random.randint(0, env.skill_num, (4, 1))
    env.step(kc)

# è®¡ç®—å¥–åŠ±
rewards = env.get_reward(full_score=3)
print(f"å¹³å‡å¥–åŠ±: {rewards.mean():.4f}")
```

---

## ğŸ“ æŠ€æœ¯è¦ç‚¹

### 1. MindSpore 2.x å…¼å®¹æ€§

å·²ä¿®å¤çš„å…¼å®¹æ€§é—®é¢˜ï¼š
- âœ… `ms_function` â†’ `jit`
- âœ… `super(ClassName).__init__()` â†’ `super(ClassName, self).__init__()`
- âœ… `tensor.repeat()` â†’ `ops.repeat_interleave()`

### 2. å¥–åŠ±è®¡ç®—å…¬å¼

```
E_p = (E_end - E_start) / (E_full - E_start + 1e-9)
```

å…¶ä¸­ï¼š
- `E_start`: åˆå§‹æŒæ¡åº¦ï¼ˆreset æ—¶è®¡ç®—ï¼‰
- `E_end`: æœ€ç»ˆæŒæ¡åº¦ï¼ˆå½“å‰çŠ¶æ€ï¼‰
- `E_full`: æ»¡åˆ†ï¼ˆé€šå¸¸ = ç›®æ ‡æ•°é‡ï¼‰

### 3. æ‰¹é‡å¤„ç†ä¼˜åŒ–

| Batch Size | å•æ ·æœ¬è€—æ—¶ | åŠ é€Ÿæ¯” |
|------------|------------|--------|
| 1 | 2932 ms | 1Ã— |
| 8 | 374 ms | **7.8Ã—** |
| 32 | 93 ms | **31.5Ã—** |

å»ºè®®ä½¿ç”¨ batch_size â‰¥ 8ã€‚

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒä¾èµ–**
   - éœ€è¦ MindSpore 2.x
   - CPU æ¨¡å¼å³å¯è¿è¡Œ
   - å·²åœ¨ `lprr1` conda ç¯å¢ƒæµ‹è¯•é€šè¿‡

2. **æ–‡ä»¶è·¯å¾„**
   - æ‰€æœ‰è„šæœ¬éœ€åœ¨ `/mnt/hpfs/xiangc/mxy/lpr-r1/DKT` ç›®å½•ä¸‹è¿è¡Œ
   - ç›¸å¯¹è·¯å¾„å¼•ç”¨ `KTScripts/`, `data/`, `SavedModels/`

3. **æ¨¡å‹çŠ¶æ€**
   - ç¯å¢ƒä¼šè‡ªåŠ¨ç®¡ç† LSTM hidden states
   - æ¯æ¬¡ `reset()` ä¼šæ¸…ç©ºçŠ¶æ€
   - ä¸è¦åœ¨ä¸åŒ episode é—´å…±äº«ç¯å¢ƒå®ä¾‹

---

## ğŸ“š æ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | ç”¨é€” |
|------|------|
| `SUMMARY.md` | æ€»ç»“æ–‡æ¡£ï¼ˆæœ¬æ–‡æ¡£ï¼‰ |
| `SETUP_GUIDE.md` | è¯¦ç»†è®¾ç½®æŒ‡å— |
| `README_DKT.md` | API å‚è€ƒæ–‡æ¡£ |
| `quick_test.py` | å¿«é€ŸéªŒè¯ |
| `test_dkt_env.py` | å®Œæ•´æµ‹è¯• |
| `example_usage.py` | ä½¿ç”¨ç¤ºä¾‹ |

---

## ğŸ‰ æ€»ç»“

âœ… **ç¬¬ 0 é˜¶æ®µå®Œæˆï¼**

- DKT ç¯å¢ƒå·²æˆåŠŸè¿ç§»å¹¶ç‹¬ç«‹è¿è¡Œ
- æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ŒåŠŸèƒ½æ­£å¸¸
- æ–‡æ¡£å®Œå¤‡ï¼Œæ˜“äºä½¿ç”¨
- å·²ä¸ºä¸‹ä¸€é˜¶æ®µï¼ˆæ„å»ºçŸ¥è¯†å›¾è°±ï¼‰åšå¥½å‡†å¤‡

**ä¸‹ä¸€æ­¥**: å¼€å§‹é˜¶æ®µ 1 - ä¸ºæ•™è‚²æ•°æ®æ„å»ºå…ˆä¿®å›¾å’Œæ¦‚å¿µè§£é‡Šã€‚

---

*æœ€åæ›´æ–°: 2025-11-20*
